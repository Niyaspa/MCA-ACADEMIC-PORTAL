{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Manage Quizzes</h2>
  <p><a class="btn small" href="{{ url_for('admin_quiz_create') }}">Create New Quiz</a></p>
  <form method="get" style="display:flex;gap:10px;align-items:center;margin:8px 0 16px;flex-wrap:wrap;">
    <div style="display:flex;gap:5px;align-items:center;">
      <label>Semester</label>
      <input name="semester" value="{{ semester or '' }}" placeholder="e.g., S1" style="width:80px;">
    </div>
    <div style="display:flex;gap:5px;align-items:center;">
      <label>Subject</label>
      <select name="subject" style="min-width:150px;">
        <option value="">All Subjects</option>
        {% for subj in available_subjects %}
          <option value="{{ subj }}" {% if subj == subject %}selected{% endif %}>{{ subj }}</option>
        {% endfor %}
      </select>
    </div>
    <button class="btn small">Filter</button>
    {% if semester or subject %}
      <a href="?" class="btn small secondary">Clear</a>
    {% endif %}
  </form>
  {% if items %}
    <table>
      <thead><tr><th>Title</th><th>Semester</th><th>Subject</th><th>Questions</th><th>Random Selection</th><th>Actions</th></tr></thead>
      <tbody>
        {% for q in items %}
          <tr>
            <td>{{ q.title }}</td>
            <td>{{ q.semester }}</td>
            <td>{{ q.subject }}</td>
            <td>{{ q.questions|length }}</td>
            <td>
              {% if q.randomize_questions %}
                <span style="color: #2196f3; font-weight: bold;">âœ“ Random</span>
                {% if q.questions_per_attempt %}
                  <br><small>{{ q.questions_per_attempt }} per attempt</small>
                {% else %}
                  <br><small>All questions</small>
                {% endif %}
              {% else %}
                <span style="color: #666;">Sequential</span>
              {% endif %}
            </td>
            <td style="display:flex;gap:6px;">
              <a class="btn small secondary" href="{{ url_for('admin_quiz_add_question', quiz_id=q.id) }}">Add Questions</a>
              <form method="post" action="{{ url_for('admin_quiz_delete', quiz_id=q.id) }}">
                <button class="btn small" onclick="return confirm('Delete quiz?')">Delete</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No quizzes yet.</p>
  {% endif %}
</div>
{% endblock %}
