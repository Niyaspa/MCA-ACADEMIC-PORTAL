{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Manage {{ rtype|capitalize }}</h2>
  <form method="get" style="display:flex;gap:10px;align-items:center;margin:8px 0 16px;flex-wrap:wrap;">
    <div style="display:flex;gap:5px;align-items:center;">
      <label>Semester</label>
      <input name="semester" value="{{ semester or '' }}" placeholder="e.g., S1" style="width:80px;">
    </div>
    <div style="display:flex;gap:5px;align-items:center;">
      <label>Subject</label>
      <select name="subject" style="min-width:150px;">
        <option value="">All Subjects</option>
        {% for subj in available_subjects %}
          <option value="{{ subj }}" {% if subj == subject %}selected{% endif %}>{{ subj }}</option>
        {% endfor %}
      </select>
    </div>
    <button class="btn small">Filter</button>
    {% if semester or subject %}
      <a href="?" class="btn small secondary">Clear</a>
    {% endif %}
  </form>
  {% if rtype == 'syllabus' %}
    <table>
      <thead><tr><th>Semester</th><th>Subject</th><th>File</th><th>Action</th></tr></thead>
      <tbody>
        {% for i in items %}
          <tr>
            <td>{{ i.semester }}</td><td>{{ i.subject }}</td>
            <td><a href="{{ url_for('download_file', sub='syllabus', filename=i.filename) }}">Download</a></td>
            <td>
              <form method="post" action="{{ url_for('admin_delete_resource', rtype='syllabus', item_id=i.id) }}">
                <button class="btn small" onclick="return confirm('Delete this item?')">Delete</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% elif rtype == 'notes' %}
    <table>
      <thead><tr><th>Semester</th><th>Subject</th><th>Title</th><th>File</th><th>Action</th></tr></thead>
      <tbody>
        {% for i in items %}
          <tr>
            <td>{{ i.semester }}</td><td>{{ i.subject }}</td><td>{{ i.title }}</td>
            <td><a href="{{ url_for('download_file', sub='notes', filename=i.filename) }}">Download</a></td>
            <td>
              <form method="post" action="{{ url_for('admin_delete_resource', rtype='notes', item_id=i.id) }}">
                <button class="btn small" onclick="return confirm('Delete this note?')">Delete</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <table>
      <thead><tr><th>Semester</th><th>Subject</th><th>Year</th><th>File</th><th>Action</th></tr></thead>
      <tbody>
        {% for i in items %}
          <tr>
            <td>{{ i.semester }}</td><td>{{ i.subject }}</td><td>{{ i.year }}</td>
            <td><a href="{{ url_for('download_file', sub='papers', filename=i.filename) }}">Download</a></td>
            <td>
              <form method="post" action="{{ url_for('admin_delete_resource', rtype='papers', item_id=i.id) }}">
                <button class="btn small" onclick="return confirm('Delete this paper?')">Delete</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</div>
{% endblock %}
